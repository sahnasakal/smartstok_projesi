{% extends "_layout.html" %}
{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Kullanıcı Yönetimi</h1>
    {% if current_user.can('manage_users') %}
    <a href="{{ url_for('add_user') }}" class="btn btn-primary">
        <i class="bi bi-person-plus"></i> Yeni Kullanıcı
    </a>
    {% endif %}
</div>

<div class="card">
    <div class="card-body">
        <table class="table table-bordered mt-2 align-middle">
            <thead>
                <tr>
                    <th style="width:80px;">ID</th>
                    <th>Kullanıcı Adı</th>
                    <th>Email</th>
                    <th>Rol</th>
                    {% if current_user.can('manage_users') %}
                    <th style="width:140px;">İşlemler</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.id }}</td>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.role.name if user.role else ('Yönetici' if user.is_admin else 'Kullanıcı') }}</td>
                    {% if current_user.can('manage_users') %}
                    <td>
                        {# İleride düzenleme eklenirse:
                        <a href="{{ url_for('edit_user', id=user.id) }}" class="btn btn-sm btn-outline-secondary">
                            <i class="bi bi-pencil"></i>
                        </a>
                        #}
                        {% if user.id != current_user.id %}
                        <form method="post" action="{{ url_for('delete_user', id=user.id) }}" class="d-inline"
                              onsubmit="return confirm('Bu kullanıcıyı silmek istediğinize emin misiniz?');">
                            <button type="submit" class="btn btn-sm btn-outline-danger">
                                <i class="bi bi-trash"></i>
                            </button>
                        </form>
                        {% endif %}
                    </td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
